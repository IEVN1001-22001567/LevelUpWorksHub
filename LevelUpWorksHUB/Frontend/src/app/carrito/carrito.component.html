<div class="min-h-screen bg-[#121212] text-white p-6">
  <div class="flex justify-between items-center mb-6">
    <h1 class="text-lg font-semibold text-yellow-500">Carrito de Compras</h1>

    <button
      class="text-red-500 hover:text-red-400 text-sm flex items-center gap-1"
      (click)="vaciar()"
      [disabled]="items.length === 0"
    >
      Vaciar
      <i class="pi pi-times text-xs"></i>
    </button>
  </div>
  <div *ngIf="items.length === 0" class="text-center text-gray-400 mt-16">
    Tu carrito está vacío.  
    <div class="mt-2 text-yellow-500 text-sm">
      Ve a la tienda y agrega algunos juegos.
    </div>
  </div>
  <div *ngFor="let item of items" class="bg-[#1a1a1a] border border-yellow-700 rounded-lg p-4 flex items-center gap-4 mb-4 hover:border-yellow-500 transition">
    <div class="w-20 h-20 bg-[#2a2a2a] border border-yellow-700 rounded flex items-center justify-center overflow-hidden flex-shrink-0">
      <img *ngIf="item.imagen"
           [src]="item.imagen"
           [alt]="item.titulo"
           class="w-full h-full object-cover">
      <span *ngIf="!item.imagen" class="text-gray-400 text-xs text-center">Sin imagen</span>
    </div>
    <div class="flex-1 min-w-0">
      <h2 class="font-semibold text-white truncate">{{ item.titulo }}</h2>
      <p class="text-yellow-500 text-sm mt-1 font-bold">
        ${{ item.precio | number:'1.2-2' }}
      </p>
      <p class="text-gray-400 text-xs mt-1">
        Cantidad: {{ item.cantidad }}
      </p>
    </div>
    <div class="flex flex-col items-end gap-3 flex-shrink-0">
      <button
        class="bg-red-600 hover:bg-red-500 text-white font-bold py-2 px-3 rounded-lg flex items-center gap-2 transition text-sm"
        (click)="eliminar(item)"
        title="Eliminar del carrito"
      >
        <i class="pi pi-trash text-sm"></i>
        <span class="hidden sm:inline">Eliminar</span>
      </button>
      <p class="text-yellow-400 font-bold text-lg">
        ${{ (item.precio * item.cantidad) | number:'1.2-2' }}
      </p>
    </div>
  </div>

  <div class="border-b border-gray-700 my-6" *ngIf="items.length > 0"></div>

  <div class="space-y-3 text-sm" *ngIf="items.length > 0">
    <div class="flex justify-between">
      <span class="text-gray-300">Subtotal:</span>
      <span class="text-white">
        ${{ subtotal | number:'1.2-2' }}
      </span>
    </div>

    <div class="flex justify-between">
      <span class="text-gray-300">IVA (16%):</span>
      <span class="text-white">
        ${{ iva | number:'1.2-2' }}
      </span>
    </div>

    <div class="flex justify-between text-lg font-semibold pt-2">
      <span class="text-yellow-500">Total:</span>
      <span class="text-yellow-500">
        ${{ total | number:'1.2-2' }}
      </span>
    </div>
  </div>

  <div
    class="mt-6 bg-yellow-700/20 text-yellow-500 border border-yellow-600 rounded-lg py-3 px-4 text-center text-sm"
    *ngIf="!isLoggedIn && items.length > 0"
  >
    Debes iniciar sesión para completar la compra
  </div>

  <div *ngIf="usuario" class="mt-4 text-sm text-gray-300">
    Saldo disponible: 
    <span class="text-yellow-400 font-semibold">
      ${{ (usuario.saldo || 0) | number:'1.2-2' }}
    </span>
  </div>

  <button
    class="mt-4 w-full bg-yellow-600 hover:bg-yellow-500 text-black font-bold py-3 rounded-lg text-center disabled:opacity-40 disabled:cursor-not-allowed"
    [disabled]="items.length === 0"
    (click)="procederPago()"
  >
    Proceder al Pago
  </button>

</div>
