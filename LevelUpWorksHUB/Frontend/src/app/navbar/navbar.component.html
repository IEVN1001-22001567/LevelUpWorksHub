<header class="bg-background border-b-4 border-primary w-full">
  <div class="max-w-screen-xl mx-auto px-4">
    <div class="flex items-center justify-between py-4">

      <div class="flex items-center gap-4">
        <div class="w-16 h-16 rounded-full border-4 border-primary overflow-hidden bg-primary">
          <img
            src="/assets/img/LevelUpLogo.jpg"
            alt="Logo"
            class="w-full h-full object-cover"
          />
        </div>

        <div class="bg-primary text-primary-foreground px-6 py-3 rounded-lg font-semibold tracking-wider">
          LEVEL UP HUB
        </div>
      </div>

      <nav class="hidden lg:flex items-center space-x-8">

        <a
          [routerLink]="['/inicio']"
          routerLinkActive="text-primary"
          class="text-card-foreground hover:text-primary transition-colors duration-200">
          Home
        </a>

        <a
          [routerLink]="['/tienda']"
          routerLinkActive="text-primary"
          class="text-card-foreground hover:text-primary transition-colors duration-200">
          Tienda
        </a>
        <div class="relative group">

          <button class="flex items-center gap-2 text-card-foreground hover:text-primary transition duration-200">
            Hub Gamer
            <span class="text-sm">‚ñº</span>
          </button>

          <div
            class="absolute left-0 mt-2 w-64 bg-[#111] border-2 border-yellow-600 shadow-lg
            opacity-0 invisible group-hover:opacity-100 group-hover:visible
            transition-all duration-200 rounded-lg z-50 flex flex-col">

            <a [routerLink]="['/biblioteca']" class="px-4 py-3 hover:bg-yellow-600 hover:text-black transition">Biblioteca de juegos</a>

            <a [routerLink]="['/noticias']" class="px-4 py-3 hover:bg-yellow-600 hover:text-black transition">Noticias</a>

            <a [routerLink]="['/eventos']" class="px-4 py-3 hover:bg-yellow-600 hover:text-black transition">Eventos y promociones</a>

            <a [routerLink]="['/psychowellness']" class="px-4 py-3 hover:bg-yellow-600 hover:text-black transition">PsychoWellness</a>

            <a [routerLink]="['/social']" class="px-4 py-3 hover:bg-yellow-600 hover:text-black transition">Mensajer√≠a</a>

            <a [routerLink]="['/resenas']" class="px-4 py-3 hover:bg-yellow-600 hover:text-black transition">Rese√±as</a>

          </div>
        </div>

        <a
          [routerLink]="['/soportetec']"
          routerLinkActive="text-primary"
          class="text-card-foreground hover:text-primary transition-colors duration-200">
          Soporte T√©cnico
        </a>

        <div class="relative group" *ngIf="esAdmin">
          <button class="flex items-center gap-2 text-red-400 hover:text-red-300 transition duration-200">
            Panel Admin
            <span class="text-sm">‚ñº</span>
          </button>

          <div
            class="absolute left-0 mt-2 w-72 bg-[#111] border-2 border-red-600 shadow-lg
            opacity-0 invisible group-hover:opacity-100 group-hover:visible
            transition-all duration-200 rounded-lg z-50 flex flex-col">

            <a [routerLink]="['/adminjuegos']" class="px-4 py-3 hover:bg-red-600 hover:text-black transition">Gesti√≥n de tienda</a>

            <a [routerLink]="['/adminusuarios']" class="px-4 py-3 hover:bg-red-600 hover:text-black transition">Gesti√≥n de usuarios</a>

            <a [routerLink]="['/adminnoticias']" class="px-4 py-3 hover:bg-red-600 hover:text-black transition">Gesti√≥n de noticias</a>

            <a [routerLink]="['/admineventos']" class="px-4 py-3 hover:bg-red-600 hover:text-black transition">Gesti√≥n de eventos</a>

            <a [routerLink]="['/adminpsycho']" class="px-4 py-3 hover:bg-red-600 hover:text-black transition">Gesti√≥n de PsicoWellness</a>

            <a [routerLink]="['adminmensajeria']" class="px-4 py-3 hover:bg-red-600 hover:text-black transition">Gesti√≥n de mensajer√≠a</a>

            <a [routerLink]="['/adminsoporte']" class="px-4 py-3 hover:bg-red-600 hover:text-black transition">Gesti√≥n de tickets de soporte</a>

            <a [routerLink]="['/adminresenas']" class="px-4 py-3 hover:bg-red-600 hover:text-black transition">Gesti√≥n de rese√±as</a>

          </div>
        </div>

      </nav>

      <div class="flex items-center gap-3">
        <ng-container *ngIf="!user; else usuarioLogueado">
          <a [routerLink]="['/login']" class="bg-primary text-primary-foreground px-4 py-2 rounded-lg hover:bg-accent transition">
            Iniciar Sesi√≥n
          </a>

          <a [routerLink]="['/carrito']" class="bg-primary text-primary-foreground px-4 py-2 rounded-lg hover:bg-accent transition">
            Carrito
          </a>
        </ng-container>
        <ng-template #usuarioLogueado>
          <div class="relative">
            <button
              (click)="toggleMenuUsuario()"
              class="flex items-center gap-2 bg-primary text-primary-foreground px-3 py-2 rounded-lg hover:bg-accent transition">

              <div class="w-10 h-10 rounded-full overflow-hidden bg-yellow-500 flex items-center justify-center text-black font-bold">
                <img
                  *ngIf="user?.avatar"
                  [src]="'http://127.0.0.1:5000/static/avatars/' + user!.avatar"
                  alt="avatar"
                  class="w-full h-full object-cover"
                />
                <span *ngIf="!user?.avatar">{{ avatarInitial }}</span>
              </div>

              <div class="flex flex-col text-left">
                <span class="text-xs leading-tight">{{ user?.username || 'Usuario' }}</span>
                <span class="text-[10px] leading-tight opacity-80">{{ user?.rol || 'Cliente' }}</span>
              </div>

              <span class="text-xs">‚ñº</span>
            </button>

            <div
              *ngIf="menuAbierto"
              class="absolute right-0 mt-2 w-48 bg-[#111] border border-yellow-600 rounded-lg shadow-lg z-50">

              <button class="w-full flex items-center gap-2 px-4 py-2 text-sm hover:bg-yellow-600 hover:text-black" (click)="irAPerfil()">
                üë§ <span>Editar perfil</span>
              </button>

              <button class="w-full flex items-center gap-2 px-4 py-2 text-sm hover:bg-yellow-600 hover:text-black" (click)="logout()">
                üö™ <span>Cerrar sesi√≥n</span>
              </button>

            </div>
          </div>

          <a [routerLink]="['/carrito']" class="bg-primary text-primary-foreground px-4 py-2 rounded-lg hover:bg-accent transition">
            Carrito
          </a>
        </ng-template>

      </div>
    </div>
  </div>
</header>
