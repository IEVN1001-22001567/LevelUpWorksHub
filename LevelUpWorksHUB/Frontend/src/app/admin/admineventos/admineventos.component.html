<div class="p-8 bg-black-100 min-h-screen">

    <!-- T√çTULO + BOT√ìN CREAR -->
    <div class="flex justify-between items-center mb-6">
        <h1 class="text-3xl font-bold text-gray-700">Gesti√≥n de Eventos</h1>

        <button
            (click)="nuevaNoticia()"
            class="bg-blue-600 text-white px-5 py-2 rounded-lg hover:bg-blue-700 transition">
            Crear Evento
        </button>
    </div>

    <!-- FORMULARIO CREAR / EDITAR -->
    <div *ngIf="mostrarFormulario" class="bg-black p-6 rounded-lg shadow-lg mb-8">

        <h2 class="text-xl font-semibold mb-4">
            {{ editando ? 'Editar Evento' : 'Crear Nuevo Evento' }}
        </h2>

        <!-- FORM -->
       <form #formEvento="ngForm" class="grid grid-cols-1 md:grid-cols-2 gap-4" (submit)="false">
    <!-- T√çTULO -->
    <div>
        <label class="font-semibold">T√≠tulo:</label>
        <input type="text" 
               [(ngModel)]="noticiaForm.titulo" 
               name="titulo"
               required
               class="w-full p-2 border rounded-lg">
    </div>

    <!-- TIPO -->
    <div>
        <label class="font-semibold">Tipo:</label>
        <input type="text" 
               [(ngModel)]="noticiaForm.tipo" 
               name="tipo"
               required
               class="w-full p-2 border rounded-lg">
    </div>

    <!-- FECHA -->
    <div>
        <label class="font-semibold">Fecha:</label>
        <input type="date" 
               [(ngModel)]="noticiaForm.fecha" 
               name="fecha"
               required
               class="w-full p-2 border rounded-lg">
    </div>

    <!-- AUTOR -->
    <div>
        <label class="font-semibold">Autor:</label>
        <input type="text" 
               [(ngModel)]="noticiaForm.autor" 
               name="autor"
               required
               class="w-full p-2 border rounded-lg">
    </div>

    <!-- DESTACADO -->
    <div>
        <label class="font-semibold">¬øEvento destacado?</label>
                <select [(ngModel)]="noticiaForm.destacado" name="destacado" class="w-full p-2 border rounded-lg">
                    <option [ngValue]="1">S√≠</option>
                    <option [ngValue]="0">No</option>
                </select>
    </div>

    <!-- ESTADO -->
    <div>
        <label class="font-semibold">Estado:</label>
        <select [(ngModel)]="noticiaForm.estado" 
                name="estado"
                class="w-full p-2 border rounded-lg">
            <option value="activo">Activo</option>
            <option value="proximo">Pr√≥ximo</option>
        </select>
    </div>

    <!-- DESCRIPCI√ìN -->
    <div class="md:col-span-2">
        <label class="font-semibold">Descripci√≥n:</label>
        <textarea [(ngModel)]="noticiaForm.descripcion"
                  name="descripcion"
                  class="w-full p-2 border rounded-lg h-28"></textarea>
    </div>

    <!-- IMAGEN -->
    <div class="md:col-span-2">
        <label class="font-semibold">Imagen:</label>
        <input type="file" class="w-full p-2 border rounded-lg" (change)="onImagenSeleccionada($event)" accept="image/*">


        <!-- PREVIEW IMG -->
        <div *ngIf="imagenPreview" class="mt-3">
            <img [src]="imagenPreview" alt="Preview"
                class="w-40 h-40 object-cover border rounded-lg">
        </div>
    </div>

</form>


        <!-- BOTONES GUARDAR / CANCELAR -->
        <div class="flex gap-4 mt-6">
            <button
            type="button"
            (click)="guardarNoticia()"
            class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">
            Guardar
            </button>

            <button
            type="button"
            (click)="cerrarFormulario()"
            class="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600">
            Cancelar
            </button>
        </div>
    </div>

    <!-- TABLA DE EVENTOS -->
    <div class="bg-black rounded-lg shadow-lg p-6">
        <h2 class="text-xl font-semibold mb-4">Lista de Eventos</h2>

        <table class="w-full border-collapse">
            <thead>
                <tr class="bg-black-200">
                    <th class="p-2 border">ID</th>
                    <th class="p-2 border">Imagen</th>
                    <th class="p-2 border">T√≠tulo</th>
                    <th class="p-2 border">Tipo</th>
                    <th class="p-2 border">Destacado</th>
                    <th class="p-2 border">Estado</th>
                    <th class="p-2 border">Fecha</th>
                    <th class="p-2 border">Acciones</th>
                </tr>
            </thead>

            <tbody>

                <tr *ngFor="let ev of noticias" class="hover:bg-gray-100">

                    <td class="p-2 border">{{ ev.even_actu_id }}</td>

                    <td class="p-2 border text-center">
                        <img *ngIf="ev.imagen"
                            [src]="'data:image/png;base64,' + ev.imagen"
                            class="w-16 h-16 object-cover rounded border mx-auto">

                    </td>

                    <td class="p-2 border">{{ ev.titulo }}</td>
                    <td class="p-2 border">{{ ev.tipo }}</td>

                    <!-- DESTACADO -->
                    <td class="p-2 border">
                        <span
                            class="px-3 py-1 rounded text-white"
                            [ngClass]="ev.destacado ? 'bg-yellow-500' : 'bg-gray-500'">
                            {{ ev.destacado ? 'S√≠' : 'No' }}
                        </span>
                    </td>

                    <!-- ESTADO -->
                    <td class="p-2 border">
                        <span
                            class="px-3 py-1 rounded text-white"
                            [ngClass]="ev.estado === 'activo' ? 'bg-green-600' : 'bg-blue-600'">
                            {{ ev.estado }}
                        </span>
                    </td>

                    <td class="p-2 border">{{ ev.fecha }}</td>

                    <td class="p-2 border flex gap-2">

                        <button
                            (click)="editarNoticia(ev)"
                            class="bg-yellow-500 text-white px-3 py-1 rounded hover:bg-yellow-600">
                            ‚úè Editar
                        </button>

                        <button
                            (click)="eliminarNoticia(ev.even_actu_id)"
                            class="bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700">
                            üóë Eliminar
                        </button>

                    </td>
                </tr>
            </tbody>
        </table>
    </div>

</div>
