<!-- CONTENEDOR PRINCIPAL -->
<div class="min-h-screen bg-[#0f0f0f] text-white px-6 py-10 flex flex-col items-center">

  <!-- T√çTULO -->
  <h1 class="text-4xl font-bold text-yellow-400 mb-2 text-center">
    Mi biblioteca de juegos
  </h1>

  <!-- SUBT√çTULO -->
  <p class="text-gray-400 text-lg mb-6 text-center">
    Gestiona tu colecci√≥n de juegos
  </p>

  <!-- BUSCADOR (SIN ngModel, SOLO (input)) -->
  <div class="flex items-center gap-3 mb-10 w-full max-w-3xl justify-center">
    <input
      type="text"
      class="w-full bg-[#1a1a1a] border border-gray-800 rounded-xl px-4 py-3 text-gray-200 focus:outline-none focus:border-yellow-400"
      placeholder="Buscar juegos..."
      (input)="searchTerm = $any($event.target).value"
    >
    <div class="p-3 bg-[#1a1a1a] border border-gray-800 rounded-xl hover:bg-[#222] cursor-pointer transition">
      <img src="assets/icons/filter.svg" class="w-6 h-6">
    </div>
  </div>

  <!-- ESTADOS -->
  <div *ngIf="cargando" class="text-gray-400 mb-4">
    Cargando biblioteca...
  </div>

  <div *ngIf="errorMsg" class="text-red-400 mb-4">
    {{ errorMsg }}
  </div>

  <div *ngIf="usuario && !cargando && juegosFiltrados().length === 0" class="text-gray-400 mb-4">
    No hay juegos en tu biblioteca.
  </div>

  <!-- GRID DE JUEGOS -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 w-full max-w-6xl">

    <div
      *ngFor="let juego of juegosFiltrados()"
      class="bg-[#1a1a1a] border border-gray-700 rounded-xl overflow-hidden hover:border-yellow-400 transition transform hover:scale-105"
    >

      <!-- IMAGEN/PORTADA -->
      <div class="w-full h-40 overflow-hidden bg-gradient-to-br from-yellow-600/20 to-blue-600/20 flex items-center justify-center relative">
        <ng-container *ngIf="juego.portada; else letra">
          <img [src]="'http://127.0.0.1:5000/static/portadas/' + juego.portada" alt="Portada" class="w-full h-full object-cover">
        </ng-container>
        <ng-template #letra>
          <span class="text-5xl font-bold text-gray-500">
            {{ (juego.titulo || '?')[0] }}
          </span>
        </ng-template>

        <div class="absolute top-2 right-2 bg-green-600/80 px-3 py-1 rounded-full text-xs font-bold">
          Pagado ‚úì
        </div>
      </div>

      <!-- INFO PRINCIPAL -->
      <div class="p-4">
        <h3 class="text-xl font-bold text-yellow-400 mb-1">{{ juego.titulo }}</h3>
        
        <p class="text-xs text-gray-500 mb-3">
          üìÖ Comprado: {{ juego.fecha_compra | date:'dd/MM/yyyy HH:mm' }}
        </p>

        <!-- DESCRIPCI√ìN -->
        <p class="text-sm text-gray-300 mb-3 line-clamp-2 min-h-10">
          {{ juego.descripcion || 'Sin descripci√≥n disponible' }}
        </p>

        <!-- (Precio removido en la biblioteca) -->

        <!-- BOTONES DE ACCI√ìN -->
        <div class="flex gap-2">
          <button
            class="flex-1 bg-yellow-500 text-black font-bold px-3 py-2 rounded-lg hover:bg-yellow-400 transition text-sm"
            (click)="descargar(juego)"
            title="Descargar el juego"
          >
            ‚¨áÔ∏è Descargar
          </button>

          <button
            class="flex-1 bg-blue-600 text-white font-bold px-3 py-2 rounded-lg hover:bg-blue-500 transition text-sm"
            (click)="jugar(juego)"
            title="Ejecutar el juego"
          >
            ‚ñ∂Ô∏è Jugar
          </button>
        </div>
      </div>
    </div>

  </div>
</div>
